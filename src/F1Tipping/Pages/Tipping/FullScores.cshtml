@page
@model F1Tipping.Pages.Tipping.FullScoresModel
@{
}

@foreach (var e in Model.Events)
{
    <div class="row">

        <div class="col border-1">
            <div class="row text-center">@(e.Name)</div>
            @foreach (var r in e.Results.OrderBy(r => r.Type))
            {
                <div class="row">
                    <div class="col-4">@Html.DisplayFor(_ => r.Type)</div>
                    <div class="col-8">@(r.ResultHolder?.DisplayName ?? "No Result.")</div>
                </div>
            }
            <div class="row">
                <div class="col-3">Event Score</div>
                <div class="col-9"></div>
            </div>
        </div>

        @foreach (var p in Model.Players)
        {
            <div class="col border-1">
                <div class="row text-center">@(p.Name)</div>
                @if (Model.Reports.TryGetValue((p.Id, e.Id), out var report))
                {
                    @foreach (var st in report.ScoredTips.OrderBy(st => st.Tip.Target.Type))
                    {
                        <div class="row">
                            <div class="col-10">@(st.Tip.Selection?.DisplayName ?? "No Tip.")</div>
                            <div class="col-2">@(st.Score)</div>
                        </div>
                    }
                    <div class="row">
                        <div class="col-10"></div>
                        <div class="col-2">@(report.EventScore)</div>
                    </div>
                }
            </div>
        }

    </div>
}
